import{S as l}from"./sweetalert2.all-950390c3.js";import{_ as V,r as a,o as g,c as v,f as n,a as e,w,F as b,n as m}from"./index-bf03b7d5.js";const{VITE_URL:p}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k={data(){return{user:{},isLoading:!1}},methods:{login(){this.isLoading=!0,this.$http.post(`${p}/v2/admin/signin`,{username:this.user.account,password:this.user.password}).then(t=>{const{expired:s,token:o}=t.data;document.cookie=`myToken=${o}; expires=${new Date(s)}`,l.fire({icon:"success",title:"登入成功",showConfirmButton:!1,timer:1e3,didClose:()=>{this.$router.push("/admin/products")}})}).catch(t=>{var s,o;l.fire({title:"錯誤發生",icon:"error",text:`${((o=(s=t.response)==null?void 0:s.data)==null?void 0:o.message)||"登入失敗"}`})}).finally(()=>{this.isLoading=!1})},check(){var s;this.isLoading=!0;const t=(s=document.cookie.split("; ").find(o=>o.startsWith("myToken=")))==null?void 0:s.split("=")[1];this.$http.defaults.headers.common.Authorization=t,this.$http.post(`${p}/v2/api/user/check`).then(o=>{o.data.success&&l.fire({icon:"success",title:"已登入",timer:2e3,showConfirmButton:!1,didClose:()=>{this.$router.push("/admin/products")}})}).finally(()=>{this.isLoading=!1})}},mounted(){this.check()}},L={class:"container min-vh-100 pt-100"},x={class:"row justify-content-center pt-5"},y={class:"col-8 col-md-6 col-lg-4"},E=e("h2",{class:"text-center"},"登入",-1),S={class:"mb-3"},C=e("label",{for:"account",class:"h5"},"帳號:",-1),T={class:"mb-4"},$=e("label",{for:"password",class:"h5"},"密碼:",-1),B={class:"text-center"},F=["disabled"];function R(t,s,o,U,i,h){const _=a("VLoading"),r=a("VField"),d=a("ErrorMessage"),f=a("VForm");return g(),v(b,null,[n(_,{active:i.isLoading},null,8,["active"]),e("div",L,[e("div",x,[e("div",y,[E,n(f,{onSubmit:h.login,class:"my-5"},{default:w(({errors:u})=>[e("div",S,[C,n(r,{id:"account",name:"帳號",type:"text",class:m(["form-control",{"is-invalid":u.帳號}]),placeholder:"請輸入 帳號",rules:"required|email",modelValue:i.user.account,"onUpdate:modelValue":s[0]||(s[0]=c=>i.user.account=c)},null,8,["class","modelValue"]),n(d,{name:"帳號",class:"invalid-feedback"})]),e("div",T,[$,n(r,{id:"password",name:"密碼",type:"password",class:m(["form-control",{"is-invalid":u.密碼}]),placeholder:"請輸入 密碼",rules:"required",modelValue:i.user.password,"onUpdate:modelValue":s[1]||(s[1]=c=>i.user.password=c)},null,8,["class","modelValue"]),n(d,{name:"密碼",class:"invalid-feedback"})]),e("div",B,[e("button",{type:"submit",class:"btn btn-theme text-white w-100 py-2",disabled:i.isLoading}," 登入 ",8,F)])]),_:1},8,["onSubmit"])])])])],64)}const I=V(k,[["render",R]]);export{I as default};
