import{S as U}from"./sweetalert2.all-60aca08f.js";import{u as L}from"./utilities-c9e10bff.js";import{m as w,_ as F,r as p,o as d,c as r,a as t,g as a,w as I,l as b,f as E,F as v,h as $,i as V,p as k,v as T,t as i,q as B,s as N,b as O}from"./index-122ae06b.js";import{c as x}from"./cartStore-ff419721.js";const{VITE_URL:R,VITE_PATH:q}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},A={data(){return{user:{}}},methods:{sentOrder(){const s={user:this.user};this.$http.post(`${R}/v2/api/${q}/order`,{data:s}).then(e=>{U.fire({title:e.data.message,html:`<div class='container'><div class="row text-start">
      <div class="col-4">
        <p class="text-theme">訂單ID:</p>
        <p class="text-theme">建立時間:</p>
        <p class="text-theme">總金額:</p>
      </div>
      <div class="col-8">
        <p>${e.data.orderId}</p>
        <p>${this.timeTransform(e.data.create_at)}</p>
        <p>$${e.data.total}</p>
      </div>
    </div></div>  
              `,confirmButtonColor:"#0FB99B"}),this.getCarts(),this.$refs.userForm.resetForm()}).catch(e=>{console.log(e)})},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需要正確的電話號碼"},...w(L,["timeTransform"])},props:["getCarts","cart"]},D={class:"bg-white"},M=t("h3",{class:"h3 text-center pt-5 text-theme"},"顧客資訊",-1),P={class:"row justify-content-center"},H={class:"col-8 col-md-6 col-lg-4"},j={class:"mb-3"},z=t("label",{for:"name",class:"h5"},"姓名:",-1),G={class:"mb-3"},X=t("label",{for:"tel",class:"h5"},"電話:",-1),J={class:"mb-3"},K=t("label",{for:"email",class:"h5"},"電子郵件:",-1),Q={class:"mb-3"},W=t("label",{for:"address",class:"h5"},"地址:",-1),Y={class:"mb-3"},Z=t("label",{for:"message",class:"h5"},"附註:",-1),tt={class:"text-center"},et=["disabled"];function st(s,e,y,S,l,f){const u=p("VField"),m=p("ErrorMessage"),g=p("VForm");return d(),r("div",D,[M,t("div",P,[t("div",H,[a(g,{onSubmit:f.sentOrder,class:"my-5",ref:"userForm"},{default:I(({errors:c})=>{var h;return[t("div",j,[z,a(u,{id:"name",name:"姓名",type:"text",class:b(["form-control",{"is-invalid":c.姓名}]),placeholder:"請輸入 姓名",rules:"required",modelValue:l.user.name,"onUpdate:modelValue":e[0]||(e[0]=n=>l.user.name=n)},null,8,["class","modelValue"]),a(m,{name:"姓名",class:"invalid-feedback"})]),t("div",G,[X,a(u,{id:"tel",name:"電話",type:"tel",class:b(["form-control",{"is-invalid":c.電話}]),placeholder:"請輸入 電話",rules:f.isPhone,modelValue:l.user.tel,"onUpdate:modelValue":e[1]||(e[1]=n=>l.user.tel=n)},null,8,["class","rules","modelValue"]),a(m,{name:"電話",class:"invalid-feedback"})]),t("div",J,[K,a(u,{id:"email",name:"電子郵件",type:"email",class:b(["form-control",{"is-invalid":c.電子郵件}]),placeholder:"請輸入 電子郵件",rules:"required||email",modelValue:l.user.email,"onUpdate:modelValue":e[2]||(e[2]=n=>l.user.email=n)},null,8,["class","modelValue"]),a(m,{name:"電子郵件",class:"invalid-feedback"})]),t("div",Q,[W,a(u,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":c.地址}]),placeholder:"請輸入 地址",rules:"required",modelValue:l.user.address,"onUpdate:modelValue":e[3]||(e[3]=n=>l.user.address=n)},null,8,["class","modelValue"]),a(m,{name:"地址",class:"invalid-feedback"})]),t("div",Y,[Z,a(u,{id:"message",name:"附註",type:"text",class:b(["form-control",{"is-invalid":c.附註}]),placeholder:"請輸入 附註",modelValue:l.user.message,"onUpdate:modelValue":e[4]||(e[4]=n=>l.user.message=n),as:"textarea",cols:"10",rows:"10"},null,8,["class","modelValue"]),a(m,{name:"地址",class:"invalid-feedback"})]),t("div",tt,[t("button",{type:"submit",class:"btn btn-theme w-100 py-2 text-white",disabled:!((h=y.cart.carts)!=null&&h.length)}," 送出 ",8,et)])]}),_:1},8,["onSubmit"])])])])}const ot=F(A,[["render",st]]);const lt={data(){return{code:""}},computed:{...E(x,["cart","cartLoading","loadingItem"])},methods:{...w(x,["updateItemNum","deleteCartItem","deleteCartAll","getCarts","useCoupon"])},components:{OrderForm:ot}},at={class:"vl-parent"},nt={class:"container-lg px-lg-5"},dt={class:"bg-white"},rt=t("h3",{class:"pt-5 text-center text-theme h3"},"購物車",-1),ct={class:"table mt-5 align-middle"},it=t("thead",null,[t("tr",null,[t("th"),t("th",{class:"text-center"},"商品圖片"),t("th",null,"商品名稱"),t("th",null,"數量/單位"),t("th",{class:"text-end"},"單價"),t("th",{class:"text-end"},"總價")])],-1),ut={class:"text-center"},mt=["disabled","onClick"],_t={class:"text-center",style:{width:"20%"}},pt=["src"],ht=["onUpdate:modelValue","onChange"],bt=["value"],vt={class:"text-end"},ft={class:"text-end"},gt={key:0},Vt={class:"text-end",colspan:"7"},yt=["disabled"],Ct={class:"bg-white mb-5"},$t={class:"table align-middle"},kt=t("td",{class:"text-theme fs-1"},null,-1),xt={style:{"min-width":"250px",width:"25%"}},wt={class:"input-group mb-3"},Ft={key:0},It={class:"text-danger ms-2"},St={class:"text-end"},Ut=t("td",null,"總金額",-1),Lt={class:"text-end"},Et=t("td",null,"優惠券折扣",-1),Tt={class:"text-danger"},Bt={class:"text-end"},Nt=t("td",null,"付款金額",-1),Ot={class:"text-theme fs-2"},Rt={key:1,class:"mt-5 py-5 text-center"},qt=t("h4",{class:"fs-2"},"目前購物車中沒有東西喔!!",-1),At=t("p",{class:"fs-4"},"趕快來看看有什麼好物吧!",-1);function Dt(s,e,y,S,l,f){var c,h,n,C;const u=p("VLoading"),m=p("RouterLink"),g=p("OrderForm");return d(),r(v,null,[t("div",at,[a(u,{active:s.cartLoading,"onUpdate:active":e[0]||(e[0]=o=>s.cartLoading=o),"can-cancel":!1,"is-full-page":!0},null,8,["active"])]),t("div",nt,[(c=s.cart.carts)!=null&&c.length?(d(),r(v,{key:0},[t("div",dt,[rt,t("table",ct,[it,t("tbody",null,[(d(!0),r(v,null,$(s.cart.carts,o=>(d(),r("tr",{key:o.id},[t("td",ut,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.loadingItem===o.id,onClick:_=>s.deleteCartItem(o.id)}," X ",8,mt)]),t("td",_t,[t("img",{src:o.product.imageUrl,alt:"",class:"cart-product-image"},null,8,pt)]),t("td",null,i(o.product.title),1),t("td",null,[k(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":_=>o.qty=_,onChange:_=>s.updateItemNum(o)},[(d(!0),r(v,null,$(o.product.stock,_=>(d(),r("option",{value:_,key:_+"123"},i(_),9,bt))),128))],40,ht),[[N,o.qty]])]),t("td",vt,i(o.product.price),1),t("td",ft,i(o.final_total),1)]))),128))]),t("tfoot",null,[(h=s.cart.carts)!=null&&h.length?(d(),r("tr",gt,[t("td",Vt,[t("button",{type:"button",class:"btn btn-outline-danger",disabled:s.loadingItem==="all",onClick:e[1]||(e[1]=o=>s.deleteCartAll())}," 清空全部 ",8,yt)])])):V("",!0)])])]),t("div",Ct,[t("table",$t,[t("tbody",null,[t("tr",null,[kt,t("td",xt,[t("div",wt,[k(t("input",{type:"text",class:"form-control",placeholder:"優惠券代碼","aria-label":"coupon","aria-describedby":"coupon-button","onUpdate:modelValue":e[2]||(e[2]=o=>l.code=o)},null,512),[[T,l.code]]),t("button",{class:"btn btn-outline-theme",type:"button",id:"coupon-button",onClick:e[3]||(e[3]=o=>s.useCoupon(`${l.code}`))}," 使用 ")]),s.cart.carts[0].coupon?(d(),r("div",Ft,[t("span",It,"已套用優惠券:"+i((n=s.cart.carts[0])==null?void 0:n.coupon.code),1)])):V("",!0)])]),t("tr",St,[Ut,t("td",null,i(s.cart.total),1)]),t("tr",Lt,[Et,t("td",null,[t("span",Tt,i(s.cart.final_total-s.cart.total),1)])]),t("tr",Bt,[Nt,t("td",Ot,i(s.cart.final_total),1)])])])])],64)):(d(),r("div",Rt,[qt,At,a(m,{to:"/products",class:"btn btn-lg btn-theme"},{default:I(()=>[O("搶購去!")]),_:1})])),(C=s.cart.carts)!=null&&C.length?(d(),B(g,{key:2,cart:s.cart,"get-Carts":s.getCarts},null,8,["cart","get-Carts"])):V("",!0)])],64)}const zt=F(lt,[["render",Dt]]);export{zt as default};
