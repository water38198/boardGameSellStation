import{j as l,k as a}from"./index-d3f30c04.js";import{S as i}from"./sweetalert2.all-df7da5c7.js";const{VITE_URL:s,VITE_PATH:r}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},u=l("cartStore",{state:()=>({cart:[],cartLoading:!1,loadingItem:"",coupon:""}),actions:{getCarts(){this.cartLoading=!0,a.get(`${s}/v2/api/${r}/cart`).then(t=>{this.cart=t.data.data,this.cartLoading=!1})},addToCart(t,o=1){this.loadingItem=t.id;const e={product_id:t.id,qty:o},c=this.cart.carts.find(n=>n.product_id===t.id);if(c&&c.product.stock<c.qty+o){i.fire({title:"出超庫存數量",icon:"error",confirmButtonColor:"#0FB99B"}),this.loadingItem="";return}this.loadingItem=t.id,a.post(`${s}/v2/api/${r}/cart`,{data:e}).then(()=>{this.getCarts(),this.loadingItem="",i.fire({position:"bottom-right",icon:"success",title:"成功加入購物車!",showConfirmButton:!1,toast:!0,timer:1500})}).catch(n=>{console.log(n)})},updateItemNum(t){const o={product_id:t.product.id,qty:t.qty};a.put(`${s}/v2/api/${r}/cart/${t.id}`,{data:o}).then(()=>{i.fire({icon:"success",title:"更新成功",showConfirmButton:!1,timer:1500,didClose:()=>{this.getCarts()}})}).catch(e=>{console.log(e.response.data.message)})},deleteCartItem(t){this.loadingItem=t,a.delete(`${s}/v2/api/${r}/cart/${t}`).then(()=>{i.fire({icon:"success",title:"刪除成功",showConfirmButton:!1,timer:1500,didClose:()=>{this.getCarts()}})}).catch(o=>{console.log(o)})},deleteCartAll(){this.loadingItem="all",i.fire({title:"確定嗎?",text:"你確定要清空購物車嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#0FB99B",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消",didClose:()=>{this.loadingItem=""}}).then(t=>{t.isConfirmed&&a.delete(`${s}/v2/api/${r}/carts`).then(()=>{i.fire("刪除成功!","購物車已清空","success"),this.getCarts()}).catch(o=>{console.log(o)})})},useCoupon(t){const o={data:{code:t}};console.log(o),a.post(`${s}/v2/api/${r}/coupon`,o).then(e=>{alert(e.data.message),this.getCarts()}).catch(e=>console.log(e))}}});export{u as c};
