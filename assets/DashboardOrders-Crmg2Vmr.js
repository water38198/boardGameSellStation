import{P as T}from"./PaginationComponent-zlwnJGbh.js";import{_ as x,S as _,M as C,o as r,c as n,a as e,C as v,K as S,n as b,F as g,i as V,t as i,e as d,w as $,H as E,r as p,p as w,d as M}from"./index-9ZAInmHq.js";var I={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:D,VITE_PATH:P}=I,U={props:{tempOrder:{type:Object,required:!0}},data(){return{modalOrder:{user:{},products:{}},isLoading:!1,modal:null}},methods:{async updateOrder(){this.isLoading=!0;try{const o=await this.axios.put(`${D}/v2/api/${P}/admin/order/${this.modalOrder.id}`,{data:this.modalOrder});_.fire({title:`${o.data.message}`,icon:"success",showConfirmButton:!1,timer:1e3,didClose:()=>{this.$emit("getOrders"),this.modal.hide()}})}catch(o){_.fire({title:"錯誤發生",icon:"error",text:`${o.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})}finally{this.isLoading=!1}},isPhone(o){return/^(09)[0-9]{8}$/.test(o)?!0:"需要09開頭的手機號碼十碼"}},watch:{tempOrder(){this.modalOrder=JSON.parse(JSON.stringify(this.tempOrder))}},mounted(){this.modal=new C("#orderModal")}},B={class:"modal fade",id:"orderModal","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"},R={class:"modal-dialog modal-dialog-centered modal-xl modal-dialog-scrollable"},F={class:"modal-content"},A=e("div",{class:"modal-header bg-light"},[e("h2",{class:"modal-title",id:"productModalLabel"}," 訂單資訊 "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),G={class:"modal-body"},H={class:"mb-6"},N=e("h3",{class:"mb-4"},"基本資訊",-1),q={class:"row"},J={class:"col-4"},j={class:"input-group"},z=e("span",{class:"input-group-text",id:"create_at"},"建立時間",-1),K=["value"],Q={class:"col-4"},W={class:"input-group"},X=e("span",{class:"input-group-text",id:"id"},"ID",-1),Y=["value"],Z={class:"col-4"},ee={class:"d-flex align-items-center"},se=e("span",{class:"me-2"},"付款狀態: ",-1),te={key:0},oe={key:1},le={class:"mb-6"},ae=e("h3",{class:"mb-4"},"商品資訊",-1),de={class:"table table-striped align-middle"},re=e("thead",null,[e("tr",null,[e("th",null,"名稱"),e("th",null,"數量"),e("th",{class:"text-end"},"單價"),e("th",{class:"text-end pe-4"},"總價")])],-1),ne={class:"text-end"},ie={class:"text-end pe-4"},ce={colspan:"4",class:"text-end pe-4"},me=e("h3",{class:"mb-4"},"顧客資訊",-1),ue={class:"col-4"},_e=e("label",{for:"username",class:"form-label"},"姓名：",-1),pe={class:"col-4"},he=e("label",{for:"email",class:"form-label"},"信箱：",-1),be={class:"col-4"},fe=e("label",{for:"tel",class:"form-label"},"電話：",-1),ge=e("label",{for:"address",class:"form-label"},"地址：",-1),ve=e("label",{for:"message",class:"form-label"},"留言：",-1),Oe={class:"modal-footer"},ye=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),xe=["disabled"];function Ve(o,t,h,L,s,c){const m=p("VField"),u=p("ErrorMessage"),f=p("VForm");return r(),n("div",B,[e("div",R,[e("div",F,[A,e("div",G,[e("div",H,[N,e("div",q,[e("div",J,[e("div",j,[z,e("input",{type:"text",class:"form-control","aria-label":"createdTime","aria-describedby":"create_at",disabled:"",value:o.$timeTransform(s.modalOrder.create_at)},null,8,K)])]),e("div",Q,[e("div",W,[X,e("input",{type:"text",class:"form-control","aria-label":"ID","aria-describedby":"id",disabled:"",value:s.modalOrder.id},null,8,Y)])]),e("div",Z,[e("div",ee,[se,v(e("input",{type:"checkbox",class:"btn-check",id:"btn-check-outlined",autocomplete:"off","onUpdate:modelValue":t[0]||(t[0]=l=>s.modalOrder.is_paid=l)},null,512),[[S,s.modalOrder.is_paid]]),e("label",{class:b(["btn",s.modalOrder.is_paid?"btn-outline-success":"btn-outline-danger"]),for:"btn-check-outlined"},[s.modalOrder.is_paid?(r(),n("span",te,"已付款 ")):(r(),n("span",oe,"尚未付款 "))],2)])])])]),e("div",le,[ae,e("table",de,[re,e("tbody",null,[(r(!0),n(g,null,V(s.modalOrder.products,(l,a)=>(r(),n("tr",{key:a},[e("td",null,i(l.product.title),1),e("td",null,i(l.qty),1),e("td",ne,"$"+i(l.product.price),1),e("td",ie,"$"+i(l.final_total),1)]))),128))]),e("tfoot",null,[e("tr",null,[e("td",ce,"總金額：$"+i(s.modalOrder.total),1)])])])]),e("div",null,[me,d(f,{id:"orderForm",class:"row g-3",onSubmit:c.updateOrder},{default:$(({errors:l})=>[e("div",ue,[_e,d(m,{id:"username",name:"姓名",type:"email",class:b(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入 姓名",rules:"required",modelValue:s.modalOrder.user.name,"onUpdate:modelValue":t[1]||(t[1]=a=>s.modalOrder.user.name=a)},null,8,["class","modelValue"]),d(u,{name:"姓名",class:"invalid-feedback"})]),e("div",pe,[he,d(m,{id:"email",name:"信箱",type:"email",class:b(["form-control",{"is-invalid":l.信箱}]),placeholder:"請輸入 信箱",rules:{required:!0,email:!0},modelValue:s.modalOrder.user.email,"onUpdate:modelValue":t[2]||(t[2]=a=>s.modalOrder.user.email=a)},null,8,["class","modelValue"]),d(u,{name:"信箱",class:"invalid-feedback"})]),e("div",be,[fe,d(m,{id:"tel",type:"tel",name:"電話",class:b(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入電話",rules:c.isPhone,modelValue:s.modalOrder.user.tel,"onUpdate:modelValue":t[3]||(t[3]=a=>s.modalOrder.user.tel=a)},null,8,["class","rules","modelValue"]),d(u,{name:"電話",class:"invalid-feedback"})]),e("div",null,[ge,d(m,{id:"address",type:"text",name:"地址",class:b(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.modalOrder.user.address,"onUpdate:modelValue":t[4]||(t[4]=a=>s.modalOrder.user.address=a)},null,8,["class","modelValue"]),d(u,{name:"地址",class:"invalid-feedback"})]),e("div",null,[ve,v(e("textarea",{name:"",id:"message",rows:"8",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=a=>s.modalOrder.user.message=a)},null,512),[[E,s.modalOrder.user.message]])])]),_:1},8,["onSubmit"])])]),e("div",Oe,[ye,e("button",{type:"submit",class:"btn btn-themeDark",disabled:s.isLoading,form:"orderForm"},"修改",8,xe)])])])])}const ke=x(U,[["render",Ve]]);var Le={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:O,VITE_PATH:y}=Le,Te={components:{PaginationComponent:T,OrderModal:ke},data(){return{orders:[],tempOrder:{},page:{},isLoading:!1}},methods:{async getOrders(o=1){this.isLoading=!0;try{const t=await this.axios.get(`${O}/v2/api/${y}/admin/orders?page=${o}`);this.orders=t.data.orders,this.page=t.data.pagination}catch(t){_.fire({title:"錯誤發生",icon:"error",text:`${t.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})}finally{this.isLoading=!1}},deleteOrder(o){_.fire({title:"確定刪除嗎?",icon:"warning",text:`確定刪除訂單編號 ${o.id} 嗎？刪除後不可復原，確定嗎?`,showCancelButton:!0,confirmButtonColor:"hsl(0,85%,60%)",confirmButtonText:"確定",cancelButtonText:"取消"}).then(async t=>{if(t.isConfirmed){this.isLoading=!0;try{const h=await this.axios.delete(`${O}/v2/api/${y}/admin/order/${o.id}`);_.fire({title:"刪除成功",icon:"success",text:`${h.data.message}`,showConfirmButton:!1,timer:1e3,didClose:()=>{this.getOrders()}})}catch(h){_.fire({title:"錯誤發生",icon:"error",text:`${h.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})}finally{this.isLoading=!1}}})},editOrder(o){this.tempOrder=o}},mounted(){this.getOrders()}},k=o=>(w("data-v-8cad1d4f"),o=o(),M(),o),Ce={class:"py-4"},Se=k(()=>e("h2",{class:"h2 text-center"},"訂單列表",-1)),$e={class:"table-responsive"},Ee={class:"table table-hover align-middle"},we=k(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"建立時間"),e("th",{scope:"col"},"ID"),e("th",{scope:"col"},"姓名"),e("th",{scope:"col"},"付款狀態"),e("th",{scope:"col",class:"text-end"},"總金額"),e("th",{scope:"col",class:"text-center",style:{width:"120px"}},"編輯")])],-1)),Me={class:"table-group-divider"},Ie={key:0,class:"text-themeDark"},De={key:1,class:"text-danger"},Pe={class:"text-end"},Ue=["onClick"],Be=["onClick"];function Re(o,t,h,L,s,c){const m=p("VLoading"),u=p("PaginationComponent"),f=p("OrderModal");return r(),n(g,null,[d(m,{active:s.isLoading},null,8,["active"]),e("div",Ce,[Se,e("div",$e,[e("table",Ee,[we,e("tbody",Me,[(r(!0),n(g,null,V(s.orders,l=>(r(),n("tr",{key:l.id},[e("td",null,i(o.$timeTransform(l.create_at)),1),e("td",null,i(l.id),1),e("td",null,i(l.user.name),1),e("td",null,[l.is_paid?(r(),n("span",Ie,"已付款")):(r(),n("span",De,"未付款"))]),e("td",Pe,"$"+i(l.total),1),e("td",null,[e("button",{type:"button",class:"btn btn-outline-success btn-sm me-2","data-bs-toggle":"modal","data-bs-target":"#orderModal",onClick:a=>c.editOrder(l)},"編輯",8,Ue),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:a=>c.deleteOrder(l)},"刪除",8,Be)])]))),128))])])])]),d(u,{pages:s.page,onGetMethod:c.getOrders},null,8,["pages","onGetMethod"]),d(f,{"temp-order":s.tempOrder,onGetOrders:c.getOrders},null,8,["temp-order","onGetOrders"])],64)}const Ge=x(Te,[["render",Re],["__scopeId","data-v-8cad1d4f"]]);export{Ge as default};
