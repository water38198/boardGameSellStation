import{P as D}from"./PaginationComponent-1313c24c.js";import{S as h}from"./sweetalert2.all-950390c3.js";import{_ as T,r as b,o as c,c as a,a as e,f as i,w as x,l as g,v as P,F as y,k as E,t as u,g as V,n as f,s as C,J as A,M as R,p as N,d as F}from"./index-bf03b7d5.js";const{VITE_URL:k,VITE_PATH:I}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},q={props:["tempProduct","isNew","closeModal","getProducts"],data(){return{newProduct:{},loadingItem:"",tempPrice:0}},methods:{updateProduct(){this.loadingItem="confirmButton";let n="post",t=`${k}/v2/api/${I}/admin/product`;this.isNew||(t+=`/${this.tempProduct.id}`,n="put"),this.$http[n](t,{data:this.newProduct}).then(()=>{h.fire({icon:"success",title:`${n==="put"?"修改成功":"新增成功"}`,showConfirmButton:!1,timer:1500,didClose:()=>{this.closeModal(),this.getProducts()}})}).catch(d=>{h.fire({title:"錯誤發生",icon:"error",text:`${d.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})}).finally(()=>{this.loadingItem=""})},uploadImage(n){let t=document.querySelector("#formFile");this.loadingItem="images",n==="main"&&(t=document.querySelector("#mainImage"),this.loadingItem="mainImage");const d=new FormData;d.append("file-to-upload",t.files[0]),this.$http.post(`${k}/v2/api/${I}/admin/upload`,d).then(m=>{m.data.imageUrl?n==="main"?this.newProduct.imageUrl=m.data.imageUrl:n==="multi"&&this.newProduct.imagesUrl.push(m.data.imageUrl):h.fire({title:"錯誤發生",icon:"error",text:`${m.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`}),t.value="",this.loadingItem=""}).catch(m=>{h.fire({title:"錯誤發生",icon:"error",text:`${m.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})})}},watch:{tempProduct(){this.newProduct={...this.tempProduct}}}},O={class:"modal-dialog modal-dialog-centered modal-xl modal-dialog-scrollable"},H={class:"modal-content"},j={class:"modal-header bg-light"},G={class:"modal-title",id:"productModalLabel"},z={key:0},J={key:1},K={class:"modal-body"},Q={class:"col-4"},W={class:"mb-5"},X=e("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),Y={class:"mb-3"},Z=["disabled"],$=["src"],ee=e("h4",null,"多圖新增",-1),te={key:0},oe={class:"d-flex justify-content-space-between"},se=["for"],le=["onClick"],ne=["onUpdate:modelValue","id"],ie=["src"],de={key:0},ce=e("p",{class:"text-center"},"或",-1),ae={class:"mb-3"},re=["disabled"],ue={class:"col-8"},me={class:"row gy-3"},pe={class:"col-12"},_e=e("label",{for:"productTitle",class:"form-label"},"商品名稱:",-1),he={class:"col-6"},ge=e("label",{for:"productCategory",class:"form-label"},"分類:",-1),fe=e("option",{selected:"",value:"策略"},"策略",-1),be=e("option",{value:"家庭"},"家庭",-1),ve=e("option",{value:"派對"},"派對",-1),Pe=e("option",{value:"陣營"},"陣營",-1),we=e("option",{value:"雙人"},"雙人",-1),ye=e("option",{value:"合作"},"合作",-1),Ue=e("option",{value:"劇情"},"劇情",-1),Ve={class:"col-3"},Me=e("label",{for:"productUnit",class:"form-label"},"單位:",-1),xe={class:"col-3"},Ce=e("label",{for:"productStock",class:"form-label"},"數量:",-1),ke={class:"col-6"},Ie=e("label",{for:"productOriginPrice",class:"form-label"},"原價:",-1),Se={class:"col-6"},Le=e("label",{for:"productPrice",class:"form-label"},"售價:",-1),Te={class:"col-4"},Ee=e("label",{for:"productLanguage",class:"form-label"},"語言",-1),Be=e("option",{selected:"",value:"繁中"},"繁中",-1),De=e("option",{value:"簡中"},"簡中",-1),Ae=e("option",{value:"英文"},"英文",-1),Re=[Be,De,Ae],Ne={class:"col-4"},Fe=e("label",{for:"productCondition",class:"form-label"},"盒況",-1),qe=e("option",{selected:"",value:"盒損"},"盒損",-1),Oe=e("option",{value:"件損"},"件損",-1),He=e("option",{value:"完好"},"完好",-1),je=e("option",{value:"其他"},"其他",-1),Ge=[qe,Oe,He,je],ze=e("hr",null,null,-1),Je={class:"col-12"},Ke=e("label",{for:"productDescription",class:"form-label"},"描述:",-1),Qe={class:"col-12"},We=e("label",{for:"productContent",class:"form-label"},"內容:",-1),Xe=e("label",{for:"is_enabled",class:"form-label"},"是否啟用",-1),Ye={class:"modal-footer"},Ze=["disabled"];function $e(n,t,d,m,o,r){const p=b("VField"),_=b("ErrorMessage"),U=b("VForm");return c(),a("div",O,[e("div",H,[e("div",j,[e("h5",G,[d.isNew?(c(),a("span",z,"新增產品")):(c(),a("span",J,"編輯產品"))]),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=l=>d.closeModal()),"aria-label":"Close"})]),e("div",K,[i(U,{onSubmit:r.updateProduct,class:"row",ref:"ProductModal",id:"ProductModal"},{default:x(({errors:l})=>[e("div",Q,[e("div",W,[X,g(e("input",{type:"text",placeholder:"請輸入圖片連結",id:"imageUrl",class:"form-control mb-2","onUpdate:modelValue":t[1]||(t[1]=s=>o.newProduct.imageUrl=s)},null,512),[[P,o.newProduct.imageUrl]]),e("div",Y,[e("input",{class:"form-control",type:"file",id:"mainImage",onChange:t[2]||(t[2]=s=>r.uploadImage("main")),disabled:o.loadingItem==="mainImage"},null,40,Z)]),e("img",{src:o.newProduct.imageUrl,alt:"main product image"},null,8,$)]),e("div",null,[ee,Array.isArray(o.newProduct.imagesUrl)?(c(),a("div",te,[(c(!0),a(y,null,E(o.newProduct.imagesUrl,(s,v)=>(c(),a(y,{key:v+5566},[e("div",oe,[e("label",{for:s,class:"form-label"},"圖片網址"+u(v+1),9,se),e("button",{type:"button",class:"btn-close btn-sm ms-auto","aria-label":"removeImage",onClick:M=>o.newProduct.imagesUrl.splice(v,1)},null,8,le)]),g(e("input",{type:"text",placeholder:"請輸入圖片連結",class:"form-control mb-1","onUpdate:modelValue":M=>o.newProduct.imagesUrl[v]=M,id:s},null,8,ne),[[P,o.newProduct.imagesUrl[v]]]),e("img",{src:s,alt:"product images",class:"img-fluid mb-4"},null,8,ie)],64))),128)),o.newProduct.imagesUrl[o.newProduct.imagesUrl.length-1]||!o.newProduct.imagesUrl.length?(c(),a("div",de,[e("button",{class:"btn btn-outline-primary w-100 mb-3",type:"button",onClick:t[3]||(t[3]=s=>o.newProduct.imagesUrl.push(""))}," 新增圖片網址 "),ce,e("div",ae,[e("input",{class:"form-control",type:"file",id:"formFile",onChange:t[4]||(t[4]=s=>r.uploadImage("multi")),disabled:o.loadingItem==="images"},null,40,re)])])):V("",!0)])):V("",!0)])]),e("div",ue,[e("div",me,[e("div",pe,[_e,i(p,{id:"productTitle",name:"商品名稱",type:"text",class:f(["form-control",{"is-invalid":l.商品名稱}]),placeholder:"請輸入 商品名稱",rules:"required",modelValue:o.newProduct.title,"onUpdate:modelValue":t[5]||(t[5]=s=>o.newProduct.title=s)},null,8,["class","modelValue"]),i(_,{name:"商品名稱",class:"invalid-feedback"})]),e("div",he,[ge,i(p,{id:"productCategory",name:"分類",class:f(["form-control",{"is-invalid":l.分類}]),placeholder:"請輸入 分類",rules:"required",modelValue:o.newProduct.category,"onUpdate:modelValue":t[6]||(t[6]=s=>o.newProduct.category=s),as:"select"},{default:x(()=>[fe,be,ve,Pe,we,ye,Ue]),_:2},1032,["class","modelValue"]),i(_,{name:"分類",class:"invalid-feedback"})]),e("div",Ve,[Me,i(p,{id:"productUnit",name:"單位",type:"text",class:f(["form-control",{"is-invalid":l.單位}]),placeholder:"請輸入 單位",rules:"required",modelValue:o.newProduct.unit,"onUpdate:modelValue":t[7]||(t[7]=s=>o.newProduct.unit=s)},null,8,["class","modelValue"]),i(_,{name:"單位",class:"invalid-feedback"})]),e("div",xe,[Ce,i(p,{id:"productStock",name:"數量",type:"number",class:f(["form-control",{"is-invalid":l.數量}]),placeholder:"請輸入 數量",rules:"required",modelValue:o.newProduct.stock,"onUpdate:modelValue":t[8]||(t[8]=s=>o.newProduct.stock=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),i(_,{name:"數量",class:"invalid-feedback"})]),e("div",ke,[Ie,i(p,{id:"productOriginPrice",name:"原價",type:"number",class:f(["form-control",{"is-invalid":l.原價}]),placeholder:"請輸入 原價",rules:{min_value:0,required:!0},modelValue:o.newProduct.origin_price,"onUpdate:modelValue":t[9]||(t[9]=s=>o.newProduct.origin_price=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),i(_,{name:"原價",class:"invalid-feedback"})]),e("div",Se,[Le,i(p,{id:"productPrice",name:"售價",type:"number",class:f(["form-control",{"is-invalid":l.售價}]),placeholder:"請輸入 售價",rules:{min_value:0,required:!0},modelValue:o.newProduct.price,"onUpdate:modelValue":t[10]||(t[10]=s=>o.newProduct.price=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),i(_,{name:"售價",class:"invalid-feedback"})]),e("div",Te,[Ee,g(e("select",{class:"form-select","aria-label":"tag","onUpdate:modelValue":t[11]||(t[11]=s=>o.newProduct.language=s),id:"productLanguage"},Re,512),[[C,o.newProduct.language]])]),e("div",Ne,[Fe,g(e("select",{class:"form-select","aria-label":"tag","onUpdate:modelValue":t[12]||(t[12]=s=>o.newProduct.condition=s),id:"productCondition"},Ge,512),[[C,o.newProduct.condition]])]),ze,e("div",Je,[Ke,g(e("textarea",{id:"productDescription",rows:"3",class:"form-control","onUpdate:modelValue":t[13]||(t[13]=s=>o.newProduct.description=s)},null,512),[[P,o.newProduct.description]])]),e("div",Qe,[We,g(e("textarea",{id:"productContent",rows:"3",class:"form-control","onUpdate:modelValue":t[14]||(t[14]=s=>o.newProduct.content=s)},null,512),[[P,o.newProduct.content]])]),e("div",null,[g(e("input",{type:"checkbox",id:"is_enabled",class:"form-check-input","onUpdate:modelValue":t[15]||(t[15]=s=>o.newProduct.is_enabled=s),"true-value":1,"false-value":0},null,512),[[A,o.newProduct.is_enabled]]),Xe])])])]),_:1},8,["onSubmit"])]),e("div",Ye,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[16]||(t[16]=(...l)=>d.closeModal&&d.closeModal(...l))}," 取消 "),e("button",{type:"submit",class:"btn btn-primary",disabled:o.loadingItem==="confirmButton",form:"ProductModal"}," 確認 ",8,Ze)])])])}const et=T(q,[["render",$e]]);const{VITE_URL:S,VITE_PATH:L}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let w={};const tt={data(){return{products:[],tempProduct:{imagesUrl:[],imageUrl:""},isNew:!0,page:{},isLoading:!1}},components:{PaginationComponent:D,ProductModal:et},methods:{getProducts(n=1){this.isLoading=!0,this.$http.get(`${S}/v2/api/${L}/admin/products?page=${n}`).then(t=>{this.products=t.data.products,this.page=t.data.pagination}).catch(t=>{h.fire({title:"錯誤發生",icon:"error",text:`${t.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})}).finally(()=>{this.isLoading=!1})},openModal(n,t){n==="new"?(this.isNew=!0,this.tempProduct={imageUrl:"",imagesUrl:[]},w.show()):n==="edit"&&(this.isNew=!1,this.tempProduct={...t},w.show()),this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[])},closeModal(){this.tempProduct={imagesUrl:[]},w.hide()},deleteProduct(n,t){h.fire({title:`確定刪除 ${n} 嗎?`,text:"刪除後不可復原，確定嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",confirmButtonText:"確定",cancelButtonColor:"#d33",cancelButtonText:"取消"}).then(d=>{d.isConfirmed&&(this.isLoading=!0,this.$http.delete(`${S}/v2/api/${L}/admin/product/${t}`).then(()=>{this.isLoading=!1,h.fire({icon:"success",title:`${n}刪除成功`,showConfirmButton:!1,timer:1e3,didClose:()=>{this.getProducts()}})}))}).catch(d=>{h.fire({title:"錯誤發生",icon:"error",text:`${d.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})})}},mounted(){this.getProducts(),w=new R("#productModal")}},B=n=>(N("data-v-152f7d2c"),n=n(),F(),n),ot={class:"row justify-content-center"},st={class:"col"},lt={class:"text-end"},nt=B(()=>e("h2",{class:"h2 text-center"},"產品列表",-1)),it={class:"table table-hover align-middle"},dt=B(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"圖片"),e("th",{scope:"col"},"產品名稱"),e("th",{scope:"col"},"類型"),e("th",{scope:"col"},"語言"),e("th",{scope:"col"},"盒況"),e("th",{scope:"col"},"原價"),e("th",{scope:"col"},"售價"),e("th",{scope:"col"},"庫存"),e("th",{scope:"col"},"是否啟用"),e("th",{scope:"col",class:"text-center"},"編輯")])],-1)),ct=["src"],at={key:0,class:"text-success"},rt={key:1,class:"text-danger"},ut={class:"text-center"},mt=["onClick"],pt=["onClick"],_t={colspan:"9",class:"text-center"},ht={class:"modal fade",id:"productModal","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"};function gt(n,t,d,m,o,r){const p=b("VLoading"),_=b("PaginationComponent"),U=b("ProductModal");return c(),a(y,null,[i(p,{active:o.isLoading},null,8,["active"]),e("div",ot,[e("div",st,[e("div",lt,[e("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=l=>r.openModal("new"))}," 建立新的產品 ")]),nt,e("table",it,[dt,e("tbody",null,[o.products?(c(!0),a(y,{key:0},E(o.products,l=>(c(),a("tr",{key:l.id},[e("td",null,[e("img",{src:l.imageUrl,alt:"productImage",class:"product-image",onerror:"this.src='../../../public/no_image_icon.png'"},null,8,ct)]),e("td",null,u(l.title),1),e("td",null,u(l.category),1),e("td",null,u(l.language),1),e("td",null,u(l.condition),1),e("td",null,u(l.origin_price),1),e("td",null,u(l.stock),1),e("td",null,u(l.price),1),e("td",null,[l.is_enabled?(c(),a("span",at,"啟用")):(c(),a("span",rt,"未啟用"))]),e("td",ut,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm me-2",onClick:s=>r.openModal("edit",l)}," 編輯 ",8,mt),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:s=>r.deleteProduct(l.title,l.id)}," 刪除 ",8,pt)])]))),128)):V("",!0)]),e("tfoot",null,[e("tr",null,[e("td",_t," 本頁有"+u(o.products.length)+"項產品 ",1)])])]),i(_,{pages:o.page,"get-Method":r.getProducts},null,8,["pages","get-Method"])])]),e("div",ht,[i(U,{"temp-product":o.tempProduct,"is-new":o.isNew,"close-Modal":r.closeModal,"get-Products":r.getProducts},null,8,["temp-product","is-new","close-Modal","get-Products"])])],64)}const Pt=T(tt,[["render",gt],["__scopeId","data-v-152f7d2c"]]);export{Pt as default};
