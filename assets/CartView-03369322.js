import{S}from"./sweetalert2.all-456922e1.js";import{u as F}from"./utilities-1c27d8d1.js";import{m as U,_ as E,r as b,o as a,c as d,a as t,g as c,w as T,q as f,f as R,F as h,j as y,h as x,s as C,v as A,t as r,u as B,x as I,b as D,p as N,i as O}from"./index-25a7f1be.js";import{c as w}from"./cartStore-b2a08ff9.js";const{VITE_URL:P,VITE_PATH:q}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},M={data(){return{user:{}}},methods:{sentOrder(){const e={user:this.user};this.$http.post(`${P}/v2/api/${q}/order`,{data:e}).then(o=>{S.fire({title:o.data.message,html:`<div class='container'><div class="row text-start">
      <div class="col-4">
        <p class="text-theme">訂單ID:</p>
        <p class="text-theme">建立時間:</p>
        <p class="text-theme">總金額:</p>
      </div>
      <div class="col-8">
        <p>${o.data.orderId}</p>
        <p>${this.timeTransform(o.data.create_at)}</p>
        <p>$${o.data.total}</p>
      </div>
    </div></div>  
              `,confirmButtonColor:"#0FB99B"}),this.getCarts(),this.$refs.userForm.resetForm()}).catch(o=>{console.log(o)})},isPhone(e){return/^(09)[0-9]{8}$/.test(e)?!0:"需要09開頭的手機號碼十碼"},...U(F,["timeTransform"])},props:["getCarts","cart"]},j={class:"bg-white"},H=t("h3",{class:"h3 text-center pt-5 text-theme"},"顧客資訊",-1),G={class:"row justify-content-center"},z={class:"col-10 col-md-8 col-lg-6"},X={class:"row"},J={class:"mb-3 col-md-6"},K=t("label",{for:"name",class:"h5"},"姓名:",-1),Q={class:"mb-3 col-md-6"},W=t("label",{for:"tel",class:"h5"},"電話:",-1),Y={class:"mb-3 col-md-6"},Z=t("label",{for:"email",class:"h5"},"電子郵件:",-1),tt={class:"mb-3 col-md-6"},et=t("label",{for:"address",class:"h5"},"地址:",-1),st={class:"mb-3"},ot=t("label",{for:"message",class:"h5"},"附註（非必填）:",-1),lt={class:"text-center"},at=["disabled"];function nt(e,o,$,L,n,g){const _=b("VField"),p=b("ErrorMessage"),V=b("VForm");return a(),d("div",j,[H,t("div",G,[t("div",z,[c(V,{onSubmit:g.sentOrder,class:"my-5",ref:"userForm"},{default:T(({errors:u})=>{var v;return[t("div",X,[t("div",J,[K,c(_,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":u.姓名}]),placeholder:"請輸入 姓名",rules:"required",modelValue:n.user.name,"onUpdate:modelValue":o[0]||(o[0]=i=>n.user.name=i)},null,8,["class","modelValue"]),c(p,{name:"姓名",class:"invalid-feedback"})]),t("div",Q,[W,c(_,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":u.電話}]),placeholder:"請輸入 電話",rules:g.isPhone,modelValue:n.user.tel,"onUpdate:modelValue":o[1]||(o[1]=i=>n.user.tel=i)},null,8,["class","rules","modelValue"]),c(p,{name:"電話",class:"invalid-feedback"})]),t("div",Y,[Z,c(_,{id:"email",name:"電子郵件",type:"email",class:f(["form-control",{"is-invalid":u.電子郵件}]),placeholder:"請輸入 電子郵件",rules:"required||email",modelValue:n.user.email,"onUpdate:modelValue":o[2]||(o[2]=i=>n.user.email=i)},null,8,["class","modelValue"]),c(p,{name:"電子郵件",class:"invalid-feedback"})]),t("div",tt,[et,c(_,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":u.地址}]),placeholder:"請輸入 地址",rules:"required",modelValue:n.user.address,"onUpdate:modelValue":o[3]||(o[3]=i=>n.user.address=i)},null,8,["class","modelValue"]),c(p,{name:"地址",class:"invalid-feedback"})]),t("div",st,[ot,c(_,{id:"message",name:"附註",type:"text",class:f(["form-control",{"is-invalid":u.附註}]),placeholder:"請輸入 想給店家的話",modelValue:n.user.message,"onUpdate:modelValue":o[4]||(o[4]=i=>n.user.message=i),as:"textarea",cols:"10",rows:"5"},null,8,["class","modelValue"]),c(p,{name:"地址",class:"invalid-feedback"})])]),t("div",lt,[t("button",{type:"submit",class:"btn btn-theme w-100 py-2 text-white",disabled:!((v=$.cart.carts)!=null&&v.length)}," 送出 ",8,at)])]}),_:1},8,["onSubmit"])])])])}const dt=E(M,[["render",nt]]);const{VITE_URL:ct,VITE_PATH:it}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},rt={data(){return{code:""}},computed:{...R(w,["cart","cartLoading","loadingItem"])},methods:{...U(w,["updateItemNum","deleteCartItem","deleteCartAll","getCarts"]),useCoupon(e){const o={data:{code:e}};this.$http.post(`${ct}/v2/api/${it}/coupon`,o).then(()=>{this.getCarts()}).catch(()=>S.fire({icon:"error",title:"哇...",text:"優惠券代碼錯誤!請確認"}))}},components:{OrderForm:dt}},m=e=>(N("data-v-ef6a89d0"),e=e(),O(),e),ut={class:"vl-parent"},_t={class:"container-lg px-lg-5"},pt={class:"bg-white px-3 px-lg-4"},mt=m(()=>t("h3",{class:"pt-5 text-center text-theme h3"},"購物車",-1)),ht={class:"d-none d-md-block"},bt={class:"table mt-5 align-middle"},vt=m(()=>t("thead",null,[t("tr",null,[t("th"),t("th",{class:"text-center"},"商品圖片"),t("th",null,"商品名稱"),t("th",null,"數量/單位"),t("th",{class:"text-end"},"單價"),t("th",{class:"text-end"},"總價")])],-1)),ft={style:{width:"50px"}},gt=["disabled","onClick"],yt={class:"text-center",style:{width:"20%"}},Vt=["src","alt"],xt=["onUpdate:modelValue","onChange"],Ct=["value"],$t={class:"text-end"},kt={class:"text-end"},It={key:0},wt={class:"text-end",colspan:"7"},St=["disabled"],Ut={class:"d-md-none list-unstyled"},Et={class:"row g-0"},Tt={class:"col-6"},Lt=["src","alt"],Ft={class:"col-6"},Rt={class:"p-2 d-flex flex-column h-100"},At={class:"card-title h6"},Bt={class:"card-text"},Dt=m(()=>t("span",{class:"mb-2"},"數量：",-1)),Nt=["onUpdate:modelValue","onChange"],Ot=["value"],Pt={class:"card-text"},qt={class:"card-text fs-6"},Mt={class:"mt-auto"},jt=["disabled","onClick"],Ht={class:"bg-white mb-5 px-3 px-lg-4"},Gt={class:"list-unstyled"},zt={class:"d-flex"},Xt={class:"input-group mb-3 ms-auto",style:{width:"250px"}},Jt={key:0,class:"text-end"},Kt={class:"text-danger ms-2"},Qt={class:"d-flex border-bottom py-3"},Wt={class:"ms-auto d-flex justify-content-between",style:{width:"300px"}},Yt=m(()=>t("span",null,"總金額：",-1)),Zt={class:"d-flex border-bottom py-3"},te={class:"ms-auto d-flex justify-content-between",style:{width:"300px"}},ee=m(()=>t("span",null,"付款金額：",-1)),se={key:1,class:"mt-5 py-5 text-center"},oe=m(()=>t("h4",{class:"fs-2"},"目前購物車中沒有東西喔!!",-1)),le=m(()=>t("p",{class:"fs-4"},"趕快來看看有什麼好物吧!",-1));function ae(e,o,$,L,n,g){var u,v,i,k;const _=b("VLoading"),p=b("RouterLink"),V=b("OrderForm");return a(),d(h,null,[t("div",ut,[c(_,{active:e.cartLoading,"onUpdate:active":o[0]||(o[0]=s=>e.cartLoading=s),"can-cancel":!1,"is-full-page":!0},null,8,["active"])]),t("div",_t,[(u=e.cart.carts)!=null&&u.length?(a(),d(h,{key:0},[t("div",pt,[mt,t("div",ht,[t("table",bt,[vt,t("tbody",null,[(a(!0),d(h,null,y(e.cart.carts,s=>(a(),d("tr",{key:s.id},[t("td",ft,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:e.loadingItem===s.id,onClick:l=>e.deleteCartItem(s.id)}," X ",8,gt)]),t("td",yt,[t("img",{src:s.product.imageUrl,alt:s.product.title+" image",class:"cart-product-image"},null,8,Vt)]),t("td",null,r(s.product.title),1),t("td",null,[C(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":l=>s.qty=l,onChange:l=>e.updateItemNum(s)},[(a(!0),d(h,null,y(s.product.stock,l=>(a(),d("option",{value:l,key:l+"123"},r(l),9,Ct))),128))],40,xt),[[I,s.qty]])]),t("td",$t,r(s.product.price),1),t("td",kt,r(s.final_total),1)]))),128))]),t("tfoot",null,[(v=e.cart.carts)!=null&&v.length?(a(),d("tr",It,[t("td",wt,[t("button",{type:"button",class:"btn btn-outline-danger",disabled:e.loadingItem==="all",onClick:o[1]||(o[1]=s=>e.deleteCartAll())}," 清空全部 ",8,St)])])):x("",!0)])])]),t("ul",Ut,[(a(!0),d(h,null,y(e.cart.carts,s=>(a(),d("li",{class:"card mb-3",key:s.id},[t("div",Et,[t("div",Tt,[t("img",{src:s.product.imageUrl,class:"rounded-start",alt:s.product.title+" image",style:{width:"100%",height:"200px","object-fit":"cover"}},null,8,Lt)]),t("div",Ft,[t("div",Rt,[t("h5",At,r(s.product.title),1),t("div",Bt,[Dt,C(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":l=>s.qty=l,onChange:l=>e.updateItemNum(s)},[(a(!0),d(h,null,y(s.product.stock,l=>(a(),d("option",{value:l,key:l+"123"},r(l),9,Ot))),128))],40,Nt),[[I,s.qty]])]),t("div",Pt,[t("small",null,"單價："+r(s.product.price),1)]),t("div",qt,"小計："+r(s.final_total),1),t("div",Mt,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:e.loadingItem===s.id,onClick:l=>e.deleteCartItem(s.id)}," 刪除 ",8,jt)])])])])]))),128))])]),t("div",Ht,[t("ul",Gt,[t("li",zt,[t("div",Xt,[C(t("input",{type:"text",class:"form-control",placeholder:"優惠券代碼","aria-label":"coupon","aria-describedby":"coupon-button","onUpdate:modelValue":o[2]||(o[2]=s=>n.code=s)},null,512),[[A,n.code]]),t("button",{class:"btn btn-outline-theme",type:"button",id:"coupon-button",onClick:o[3]||(o[3]=s=>g.useCoupon(`${n.code}`))}," 使用 ")])]),t("li",null,[e.cart.carts[0].coupon?(a(),d("div",Jt,[t("span",Kt,"已套用優惠券:"+r((i=e.cart.carts[0])==null?void 0:i.coupon.code),1)])):x("",!0)]),t("li",Qt,[t("div",Wt,[Yt,t("span",null,r(e.cart.total),1)])]),t("li",Zt,[t("div",te,[ee,t("span",null,r(e.cart.final_total),1)])])])])],64)):(a(),d("div",se,[oe,le,c(p,{to:"/products",class:"btn btn-lg btn-theme"},{default:T(()=>[D("搶購去!")]),_:1})])),(k=e.cart.carts)!=null&&k.length?(a(),B(V,{key:2,cart:e.cart,"get-Carts":e.getCarts},null,8,["cart","get-Carts"])):x("",!0)])],64)}const re=E(rt,[["render",ae],["__scopeId","data-v-ef6a89d0"]]);export{re as default};
