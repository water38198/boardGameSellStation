import{k as l,l as i}from"./index-25a7f1be.js";import{S as e}from"./sweetalert2.all-456922e1.js";const{VITE_URL:a,VITE_PATH:s}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/boardGameSellStation/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},u=l("cartStore",{state:()=>({cart:[],cartLoading:!1,loadingItem:"",coupon:""}),actions:{getCarts(){this.cartLoading=!0,i.get(`${a}/v2/api/${s}/cart`).then(t=>{this.cart=t.data.data,this.cartLoading=!1})},addToCart(t,o=1){this.loadingItem=t.id;const r={product_id:t.id,qty:o},c=this.cart.carts.find(n=>n.product_id===t.id);if(c&&c.product.stock<c.qty+o){e.fire({title:"出超庫存數量",icon:"error",confirmButtonColor:"#0FB99B"}),this.loadingItem="";return}this.loadingItem=t.id,i.post(`${a}/v2/api/${s}/cart`,{data:r}).then(()=>{this.getCarts(),this.loadingItem="",e.fire({position:"bottom-right",icon:"success",title:"成功加入購物車!",showConfirmButton:!1,toast:!0,timer:1500})}).catch(n=>{console.log(n)})},updateItemNum(t){const o={product_id:t.product.id,qty:t.qty};i.put(`${a}/v2/api/${s}/cart/${t.id}`,{data:o}).then(()=>{e.fire({icon:"success",title:"更新成功",showConfirmButton:!1,timer:1500,didClose:()=>{this.getCarts()}})}).catch(r=>{console.log(r.response.data.message)})},deleteCartItem(t){this.loadingItem=t,i.delete(`${a}/v2/api/${s}/cart/${t}`).then(()=>{e.fire({icon:"success",title:"刪除成功",showConfirmButton:!1,timer:1500,didClose:()=>{this.getCarts()}})}).catch(o=>{console.log(o)})},deleteCartAll(){this.loadingItem="all",e.fire({title:"確定嗎?",text:"你確定要清空購物車嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#0FB99B",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消",didClose:()=>{this.loadingItem=""}}).then(t=>{t.isConfirmed&&i.delete(`${a}/v2/api/${s}/carts`).then(()=>{e.fire("刪除成功!","購物車已清空","success"),this.getCarts()}).catch(o=>{console.log(o)})})}}});export{u as c};
